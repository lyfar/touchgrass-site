# Didgeridoo — Comprehensive Research for Sound Healing iOS App

> Last updated: 2026-02-08
> Sources: UNSW Acoustics Lab (Fletcher, Wolfe, Tarnopolsky), UBC Physics, BMJ (Puhan et al. 2006), PMC/JEBIM (2019 RCT), Wikipedia, Didgeridata, DidgeProject, KVR Audio, CCRMA Stanford

---

## 1. Physical Acoustics

### How Sound Is Produced

The didgeridoo is a **lip-reed aerophone** — the player buzzes their lips at the narrow (mouthpiece) end of a gently flaring wooden tube. The mechanism is identical in principle to brass instruments (tuba, trumpet):

1. **Lips vibrate** under muscular tension, acting as a pressure-controlled valve
2. A pulse of air enters the tube, travels to the open end, reflects, and returns
3. If the lip vibration frequency matches a resonance of the tube, sustained oscillation occurs
4. The lip valve is **nonlinear** — lips close completely each cycle, generating rich harmonics (1:2:3:4:…)

The lip valve is classified as a **(+, −)** or **(+, +)** valve (Helmholtz/Fletcher classification), meaning excess mouth pressure tends to open the valve.

### Bore Geometry & Resonance Modes

The didgeridoo is modeled as a **truncated conical horn**:
- Length L ≈ 1.0–1.5 m (traditional), up to 3 m possible
- Mouthpiece diameter d₁ ≈ 26–31 mm
- Bell diameter d₂ ≈ 36–60 mm
- Wall thickness: 5–10 mm

**Resonance formula** (Fletcher 1996):
```
fₙ = (n − ½)c / 2L'   (for nearly cylindrical)
L' = L + 0.3 × d₂      (end correction)
```

For conical bore, the fundamental is raised by a factor of **1.06–1.38** relative to a pure cylinder of equal length.

**Key acoustic properties:**
- **Fundamental (drone):** 50–80 Hz typically (B₁ to E₂)
- **Second resonance (overblow/toot):** approximately an **11th above** the fundamental (frequency ratio ~8:3, or somewhat less than 3:1) — NOT a clean harmonic
- **Resonance series:** "stretched quasiharmonic sequence" — resonances do NOT fall in harmonic ratios due to bore irregularities and flare
- **Impedance peaks:** First peak 8–30 MPa·s·m⁻³; quality instruments have WEAK peaks in 1–2 kHz range (allows vocal tract formant control)

### Vocal Tract Interaction — The Two-Resonator System

This is what makes the didgeridoo unique — the player's vocal tract is the **second resonator**:

1. **Lip vibrations** excite both the instrument bore AND the vocal tract simultaneously
2. The vocal tract acts "backwards" compared to speech — it modifies harmonics already generated by the lips
3. **Tongue position** controls formant frequencies:
   - High tongue ("ee") → formant ~2.0–2.5 kHz
   - Low tongue ("aw") → formant ~1.0–1.5 kHz
   - Neutral → formant ~1.3 kHz
4. **Vocal fold position:** Nearly closed (whispering position) creates stronger tract resonances
5. **During circular breathing:** Mouth sealed from throat → only mouth cavity acts as resonator (shorter cavity, higher resonant frequencies)

### Formant Frequencies (Critical for Synthesis)

| Vocal Shape | Formant Range | Character |
|---|---|---|
| "aw" / open | 800–1200 Hz | Dark, deep drone |
| "ee" / closed | 1500–2500 Hz | Bright, nasal |
| "oo" / rounded | 600–1000 Hz | Warm, hollow |
| Transition | Sweeps 800–2200 Hz | The characteristic "wah-wah" |
| Lower formant | ~500 Hz | Always present, subtle |

### Frequency Spectrum

The didgeridoo sound spectrum contains:
- **Fundamental** (the drone): 50–80 Hz, dominant
- **Harmonics**: 2f, 3f, 4f, 5f… up to 20+ harmonics audible
- **Spectral envelope**: Initially flat, then declines at ~12 dB/octave
- **Formant band**: Enhanced region at 1–2 kHz (controlled by vocal tract)
- **Radiation characteristic**: +6 dB/octave below ~3 kHz, then flat above

### Vocalizations (Singing into the instrument)

When vocal folds vibrate at frequency g while lips vibrate at f:
- Produces: f-g, f+g, 2f-g, 2f+g, etc. (sum/difference tones)
- Creates extremely complex, rich spectra
- Used for animal sounds, rhythmic accents

---

## 2. Real-World Frequency Data

### Fundamental Frequencies by Key

| Key | Frequency (Hz) | Typical Length (mm) | Character |
|---|---|---|---|
| C₁ | 32.70 | 2630 | Extremely deep, rare |
| D₁ | 36.71 | 2342 | Very deep |
| E₁ | 41.20 | 2087 | Deep |
| G₁ | 49.00 | 1755 | Low |
| A₁ | 55.00 | 1564 | Low-medium |
| B₁ | 61.74 | 1393 | Traditional medium |
| **C₂** | **65.40** | **1315** | **Common beginner key** |
| C#₂ | 69.30 | 1241 | Medium |
| **D₂** | **73.42** | **1171** | **Most popular key** |
| D#₂ | 77.78 | 1106 | Medium-high |
| **E₂** | **82.41** | **1044** | **Popular, bright** |
| F₂ | 87.31 | 985 | High |
| G₂ | 98.00 | 878 | Very high |
| A₂ | 110.00 | 782 | Extremely high |

**Length formula:** `L = c / (4 × f)` where c = 344 m/s (20°C dry air)

### Standard/Recommended Keys for Sound Healing

- **C₂ (65.4 Hz):** Root chakra association, deep grounding
- **D₂ (73.4 Hz):** Sacral chakra, most popular all-around key
- **E₂ (82.4 Hz):** Solar plexus, bright and energetic
- **F₂ (87.3 Hz):** Heart chakra
- **432 Hz tuning:** Some healing practitioners prefer A=432 Hz (slightly lower than concert A=440 Hz), giving slightly different Hz values for each note

### Overtone Series (from D₂ = 73.4 Hz fundamental)

| Harmonic | Frequency | Interval | Note (approx) |
|---|---|---|---|
| 1 (fundamental) | 73.4 Hz | — | D₂ |
| 2 | 146.8 Hz | Octave | D₃ |
| 3 | 220.2 Hz | 5th above | A₃ |
| 4 | 293.6 Hz | Octave | D₄ |
| 5 | 367.0 Hz | Maj 3rd | F#₄ |
| 6 | 440.4 Hz | 5th | A₄ |
| 7 | 513.8 Hz | ~b7 | C₅ (flat) |
| 8 | 587.2 Hz | Octave | D₅ |
| 10 | 734.0 Hz | Maj 3rd | F#₅ |
| 12 | 880.8 Hz | 5th | A₅ |
| 15 | 1101.0 Hz | — | C#₆ |
| 20 | 1468.0 Hz | — | F#₆ |

**Note:** Actual bore resonances are "stretched" — not exact integer ratios. Second playing resonance (toot) ≈ 11th above ≈ 191–220 Hz for a D₂ instrument.

### Typical Blowing Pressures
- Drone: 1–2 kPa (10–20 cm water gauge)
- Second mode (toot): 4–5 kPa
- Third mode and above: rarely used

---

## 3. Digital Synthesis Approaches

### Recommended Architecture: Hybrid Waveguide + Formant Synthesis

For a real-time iOS implementation, the best approach combines:

1. **Digital Waveguide** (delay line) for the bore resonance
2. **Lip-reed model** for the excitation
3. **Formant filter** for vocal tract simulation
4. **Noise injection** for breath/texture

### 3A. Waveguide Bore Model

```
[Lip Excitation] → [Delay Line (bore length)] → [Low-pass filter (losses)]
                          ↑                              ↓
                          └──────── [Reflection] ←───────┘
```

- **Delay line length** = sampleRate / (2 × fundamentalFreq)
  - For D₂ at 44100 Hz: 44100/(2×73.4) ≈ 300 samples
- **Feedback filter:** 1-pole lowpass, cutoff ~3000 Hz (simulates air friction losses)
- **Reflection coefficient:** ~0.95–0.99 (open end reflects most energy back)

### 3B. Lip-Reed Excitation Model

The lip reed generates a quasi-sinusoidal but clipped waveform:

```
lipOpening = lipBias + lipAmplitude × sin(2π × lipFreq × t)
lipOpening = max(0, lipOpening)  // lips can't open negative
flow = γ × lipOpening × sqrt(blowPressure - borePressure)
```

**Parameters:**
- `lipFreq`: ≈ fundamental frequency (50–80 Hz typically)
- `lipBias` (a₀): average lip opening (0.3–0.7 normalized)
- `lipAmplitude` (a): vibration amplitude (≈ a₀, lips just barely close)
- `blowPressure`: 0.4–0.8 normalized (maps to 1–5 kPa)
- γ: flow coefficient

### 3C. Vocal Tract / Formant Filter (THE KEY TO REALISM)

This is what makes or breaks the didgeridoo sound. Use **two bandpass filters** in series (or parallel) to create controllable formants:

```
Formant 1: center = 500–1200 Hz, Q = 5–15
Formant 2: center = 1200–2500 Hz, Q = 5–15
```

**User controls tongue position** → sweeps Formant 2 center frequency between 1000–2500 Hz.

Also add **anti-formant (notch)** at the vocal tract resonance frequencies (where harmonics are suppressed):
- Notch at ~1000 Hz when tongue is in "ee" position
- Notch sweeps with tongue position

### 3D. ADSR / Envelope

Didgeridoo is a **continuous drone** — no traditional ADSR:

| Phase | Duration | Character |
|---|---|---|
| Attack | 100–300 ms | Lips engage, pressure builds |
| Sustain | Infinite (circular breathing) | Continuous drone |
| Circular breath dip | 200–500 ms | Brief timbre change, amplitude dip ~3-6 dB |
| Release | 300–800 ms | Pressure drops, pitch sags slightly |

**Amplitude envelope during circular breathing:**
```
┌──────┐  ┌──────┐  ┌──────┐
│      │  │      │  │      │
│      └──┘      └──┘      └── (repeated pattern)
│ blow  │br│ blow  │br│ blow │
```
Where "br" = breath intake (~200ms, amplitude dips 3-6 dB, formant shifts up)

### 3E. Alternative: Additive/Spectral Synthesis

The ICMC 2010 paper (Ayers & Horner) describes **additive synthesis with timbre morphing** in Csound:
- Model 20–30 harmonics with individual amplitude envelopes
- Morph between spectral snapshots ("aw" → "ee" → toot)
- More flexible but more CPU-intensive than waveguide

### Key Parameters for iOS UI

| Parameter | Range | Maps To |
|---|---|---|
| Blow pressure | 0.0–1.0 | Volume + harmonic richness |
| Lip tension | 0.0–1.0 | Fundamental freq + toot access |
| Tongue position | 0.0–1.0 | Formant frequency (dark→bright) |
| Mouth shape | 0.0–1.0 | Formant bandwidth (focused→wide) |
| Vocalization pitch | 0–500 Hz | Vocal fold pitch for singing-into |
| Vocalization mix | 0.0–1.0 | Blend of vocal excitation |
| Circular breathing | Boolean/auto | Rhythmic breath pattern |

---

## 4. Sound Healing Applications

### 4A. Clinical Evidence

#### Puhan et al. (2006) — BMJ RCT (The Landmark Study)
- **Citation:** Puhan MA et al. "Didgeridoo playing as alternative treatment for obstructive sleep apnoea syndrome: randomised controlled trial." BMJ 2006;332:266-270
- **Design:** Randomized controlled trial, 25 patients
- **Inclusion:** Adults with moderate OSA (AHI 15-30), snoring
- **Intervention:** 4 months didgeridoo practice (avg 5.9 days/week, 25.3 min/day)
- **Instrument:** Standardized 130cm acrylic plastic didgeridoo, 4cm diameter
- **Results:**
  - Daytime sleepiness (Epworth): **-3.0 points** (p=0.03)
  - Apnoea-Hypopnoea Index: **-6.2 episodes/hr** (p=0.05)
  - Partner sleep disturbance: **-2.8 points** (p<0.01)
  - Combined sleep outcomes: **-0.78 SD units** (p<0.01) = moderate-to-large effect
- **Mechanism:** Training upper airway dilator muscles through circular breathing and lip vibration
- **Conclusion:** "Regular didgeridoo playing is an effective treatment alternative well accepted by patients with moderate obstructive sleep apnoea syndrome"

#### Didge You Sleep (2024) — Feasibility Follow-up
- Confirmed feasibility of didgeridoo training for OSA
- Replicated core findings of Puhan et al.

#### Didgeridoo Sound Meditation RCT (2019) — PMC6769210
- **Citation:** Published in J Evidence-Based Integrative Medicine
- **Design:** RCT, 74 undergraduates, no prior meditation experience
- **Comparison:** 30-min live didgeridoo meditation vs. silent breath meditation
- **Results:**
  - Both groups: ↓ negative arousal, tiredness, energy, acute stress (all p<0.02)
  - Didgeridoo group: **significantly more relaxation** (p=0.01)
  - Didgeridoo group: **significantly less acute stress** (p=0.03)
  - 80% of didgeridoo group would attend again (vs 53% silent)
  - 80% enjoyed it (vs 47% silent)
- **Conclusion:** "Didgeridoo sound meditation is as effective as silent meditation for decreasing self-perceived negative arousal, tiredness, and energy and **more effective** than silent meditation for relaxation and acute stress"

#### Meta-Analysis: Wind Instruments & Sleep Apnea (JCSM)
- Confirmed didgeridoo is "moderately effective in patients with sleep apnea syndrome"

### 4B. Therapeutic Mechanisms

1. **Upper airway muscle training:** Circular breathing and lip vibration strengthen pharyngeal dilator muscles → reduces airway collapse during sleep
2. **Brainwave entrainment:** The 50–80 Hz fundamental and its beat frequencies can entrain brainwaves:
   - **Delta (0.5–4 Hz):** Deep sleep, healing — achieved when two didgeridoos play frequencies ~2 Hz apart
   - **Theta (4–8 Hz):** Deep meditation, trance — didgeridoo drone naturally induces theta states
   - **Alpha (8–13 Hz):** Relaxation — formant modulation rhythms often fall in alpha range
3. **Vagal nerve stimulation:** Low-frequency vibrations from playing/listening stimulate the vagus nerve → parasympathetic activation
4. **Respiratory regulation:** Circular breathing enforces slow, controlled breathing patterns
5. **Vibroacoustic therapy:** Sub-100 Hz frequencies felt physically, promoting relaxation and pain reduction

### 4C. Practitioner Techniques

| Technique | Description | Therapeutic Use |
|---|---|---|
| Steady drone | Continuous fundamental, minimal variation | Deep relaxation, sleep preparation |
| Formant sweeps | Slow "wah-wah" tongue movements | Brainwave entrainment, trance |
| Rhythmic breathing | Emphasized circular breathing pattern | Anxiety reduction, grounding |
| Overtone singing | Vocalizing into the instrument | Energy work, chakra activation |
| Toot accents | Brief overblown notes | Alerting, clearing energy |
| Body scanning | Moving instrument near body parts | Vibroacoustic therapy |
| Two-drone binaural | Two didgeridoos at slightly different pitches | Specific brainwave state induction |

### 4D. Chakra Associations (Practitioner Framework)

| Chakra | Key | Frequency | Use |
|---|---|---|---|
| Root (Muladhara) | C | 65.4 Hz | Grounding, security |
| Sacral (Svadhisthana) | D | 73.4 Hz | Creativity, emotional flow |
| Solar Plexus (Manipura) | E | 82.4 Hz | Personal power, confidence |
| Heart (Anahata) | F | 87.3 Hz | Love, compassion |

---

## 5. Interaction Design for iOS

### Primary Interface Concept: "Virtual Bore"

The screen shows a **side-view cross-section** of the didgeridoo bore with visual feedback:

```
┌─────────────────────────────────────────────┐
│  [Mouthpiece]═══════════════════════[Bell]   │
│                                              │
│  ┌─────────────────────────────┐             │
│  │  Touch area: vertical =     │             │
│  │  blow pressure              │             │
│  │  horizontal = tongue pos    │             │
│  └─────────────────────────────┘             │
│                                              │
│  Waveform visualization inside bore          │
│  Formant spectrum display                    │
│                                              │
│  [Key selector]  [Breath pattern]  [FX]      │
└─────────────────────────────────────────────┘
```

### Touch Mapping

| Gesture | Parameter | Musical Effect |
|---|---|---|
| **Touch & hold** (Y position) | Blow pressure (0–1) | Volume + harmonic richness |
| **Drag horizontal** | Tongue position (dark↔bright) | Formant sweep ("wah-wah") |
| **Two-finger vertical** | Lip tension | Access toots/overblows |
| **Pinch** | Mouth opening | Formant bandwidth |
| **Long press + release** | Circular breathing toggle | Auto-rhythmic breath pattern |
| **Double tap** | Toot accent | Brief overblow note |
| **Swipe up** | Vocalization pitch | Singing into instrument |
| **3D Touch / pressure** | Blow pressure (if available) | More natural dynamics |

### Sound Healing Mode

Simplified interface for meditation/therapy:
- **Single touch to start drone** — auto-sustain with circular breathing
- **Slow drag** for formant sweeps → creates the meditative "wah-wah"
- **Timer selection:** 5/10/15/30/60 min sessions
- **Preset drone keys:** C, D, E, F (with chakra labels)
- **Binaural mode:** Two simultaneous drones with ±2-8 Hz detuning for brainwave entrainment
- **Visual breathing guide** synced to circular breathing rhythm

### Visual Feedback

- **Bore resonance visualization:** Standing wave animation inside the tube
- **Spectrum analyzer:** Real-time formant display (helpful for learning)
- **Breathing indicator:** Circular animation synced to breath cycle
- **Chakra overlay** (healing mode): Glowing energy center matching the key

---

## 6. Synthesis Pseudocode (Swift-like)

```swift
class DidgeridooSynthesizer {
    // === Core Parameters ===
    var sampleRate: Float = 44100.0
    var fundamentalFreq: Float = 73.4  // D2
    
    // === Waveguide Bore ===
    var delayLine: [Float]          // circular buffer
    var delayLength: Int            // sampleRate / (2 * fundamentalFreq)
    var writeIndex: Int = 0
    var feedbackCoeff: Float = 0.995 // high feedback for sustained drone
    
    // === Lip Reed ===
    var lipFreq: Float = 73.4
    var lipPhase: Float = 0.0
    var lipBias: Float = 0.5         // average opening
    var lipAmplitude: Float = 0.48   // just barely closes
    var blowPressure: Float = 0.6    // 0.0–1.0
    
    // === Formant Filters ===
    var formant1: BiquadFilter       // ~500–800 Hz, low formant
    var formant2: BiquadFilter       // 1000–2500 Hz, main movable formant
    var antiFormant: BiquadFilter    // Notch filter at vocal tract resonance
    
    // === State ===
    var tonguePosition: Float = 0.5  // 0=dark("aw"), 1=bright("ee")
    var breathPhase: Float = 0.0     // circular breathing cycle
    var isBreathing: Bool = false
    
    // === Low-pass filter for bore losses ===
    var boreFilter: OnePoleFilter    // cutoff ~3000 Hz
    
    init(fundamentalFreq: Float) {
        self.fundamentalFreq = fundamentalFreq
        self.lipFreq = fundamentalFreq
        
        delayLength = Int(sampleRate / (2.0 * fundamentalFreq))
        delayLine = [Float](repeating: 0.0, count: delayLength)
        
        // Initialize bore loss filter
        boreFilter = OnePoleFilter(cutoff: 3000.0, sampleRate: sampleRate)
        
        // Initialize formant filters
        formant1 = BiquadFilter.bandpass(
            center: 700.0, Q: 8.0, sampleRate: sampleRate
        )
        formant2 = BiquadFilter.bandpass(
            center: 1500.0, Q: 10.0, sampleRate: sampleRate
        )
        antiFormant = BiquadFilter.notch(
            center: 1200.0, Q: 5.0, sampleRate: sampleRate
        )
    }
    
    func setTonguePosition(_ pos: Float) {
        // pos: 0.0 = "aw" (dark), 1.0 = "ee" (bright)
        tonguePosition = pos
        
        // Sweep main formant: 900 Hz → 2400 Hz
        let formant2Freq = 900.0 + pos * 1500.0
        formant2.setCenter(formant2Freq, Q: 8.0 + pos * 6.0)
        
        // Sweep anti-formant (notch)
        let notchFreq = 700.0 + pos * 1200.0
        antiFormant.setCenter(notchFreq, Q: 4.0)
        
        // Low formant adjusts slightly
        let formant1Freq = 500.0 + pos * 300.0
        formant1.setCenter(formant1Freq, Q: 6.0)
    }
    
    func processCircularBreathing(deltaTime: Float) -> Float {
        // Returns amplitude multiplier for breath cycle
        // Typical cycle: 3-5 seconds blow, 0.2-0.5 seconds breathe
        let cycleLength: Float = 4.0   // seconds
        let breathDuration: Float = 0.3 // seconds
        
        breathPhase += deltaTime / cycleLength
        if breathPhase > 1.0 { breathPhase -= 1.0 }
        
        let breathStart = 1.0 - (breathDuration / cycleLength)
        if breathPhase > breathStart {
            // During breath intake - amplitude dip
            let breathProgress = (breathPhase - breathStart) / (1.0 - breathStart)
            let dip = 1.0 - 0.4 * sin(Float.pi * breathProgress) // ~3-6 dB dip
            isBreathing = true
            return dip
        }
        isBreathing = false
        return 1.0
    }
    
    func generateSample() -> Float {
        // === 1. Read from delay line (bore feedback) ===
        let readIndex = (writeIndex - delayLength + delayLine.count) % delayLine.count
        let borePressure = delayLine[readIndex]
        
        // === 2. Lip reed model ===
        lipPhase += lipFreq / sampleRate
        if lipPhase > 1.0 { lipPhase -= 1.0 }
        
        let lipOpening = max(0.0, lipBias + lipAmplitude * sin(2.0 * .pi * lipPhase))
        let pressureDiff = max(0.0, blowPressure - borePressure * 0.3)
        let flow = lipOpening * sqrt(pressureDiff)
        
        // === 3. Add slight noise (breath turbulence) ===
        let noise = Float.random(in: -0.02...0.02)
        let excitation = flow + noise * blowPressure
        
        // === 4. Inject into delay line ===
        let delayed = boreFilter.process(borePressure * feedbackCoeff)
        delayLine[writeIndex] = excitation + delayed
        writeIndex = (writeIndex + 1) % delayLine.count
        
        // === 5. Read output (from "bell" end) ===
        var output = delayLine[readIndex]
        
        // === 6. Apply formant filters (vocal tract effect) ===
        let f1 = formant1.process(output)
        let f2 = formant2.process(output)
        let notched = antiFormant.process(output)
        
        // Mix: original signal shaped by formants
        output = notched * 0.4 + f1 * 0.3 + f2 * 0.3
        
        // === 7. Apply circular breathing envelope ===
        let breathEnv = processCircularBreathing(deltaTime: 1.0 / sampleRate)
        output *= breathEnv
        
        // === 8. Soft saturation (warmth) ===
        output = tanh(output * 2.0) * 0.5
        
        return output
    }
}

// === Helper: One-Pole Lowpass Filter ===
class OnePoleFilter {
    var a0: Float
    var b1: Float
    var z1: Float = 0.0
    
    init(cutoff: Float, sampleRate: Float) {
        let w = 2.0 * Float.pi * cutoff / sampleRate
        b1 = exp(-w)
        a0 = 1.0 - b1
    }
    
    func process(_ input: Float) -> Float {
        z1 = input * a0 + z1 * b1
        return z1
    }
}

// === Helper: Biquad Filter ===
class BiquadFilter {
    var b0, b1, b2, a1, a2: Float
    var x1, x2, y1, y2: Float
    
    static func bandpass(center: Float, Q: Float, sampleRate: Float) -> BiquadFilter {
        // Standard biquad bandpass coefficient calculation
        let w0 = 2.0 * Float.pi * center / sampleRate
        let alpha = sin(w0) / (2.0 * Q)
        let filter = BiquadFilter()
        filter.b0 = alpha
        filter.b1 = 0
        filter.b2 = -alpha
        filter.a1 = -2.0 * cos(w0)
        filter.a2 = 1.0 - alpha
        // Normalize by (1 + alpha)
        let norm = 1.0 / (1.0 + alpha)
        filter.b0 *= norm; filter.b1 *= norm; filter.b2 *= norm
        filter.a1 *= norm; filter.a2 *= norm
        return filter
    }
    
    static func notch(center: Float, Q: Float, sampleRate: Float) -> BiquadFilter {
        let w0 = 2.0 * Float.pi * center / sampleRate
        let alpha = sin(w0) / (2.0 * Q)
        let filter = BiquadFilter()
        filter.b0 = 1.0
        filter.b1 = -2.0 * cos(w0)
        filter.b2 = 1.0
        filter.a1 = -2.0 * cos(w0)
        filter.a2 = 1.0 - alpha
        let norm = 1.0 / (1.0 + alpha)
        filter.b0 *= norm; filter.b1 *= norm; filter.b2 *= norm
        filter.a1 *= norm; filter.a2 *= norm
        return filter
    }
    
    func process(_ input: Float) -> Float {
        let output = b0 * input + b1 * x1 + b2 * x2 - a1 * y1 - a2 * y2
        x2 = x1; x1 = input
        y2 = y1; y1 = output
        return output
    }
    
    func setCenter(_ freq: Float, Q: Float) {
        // Recalculate coefficients (same as init, updates in-place)
    }
}

// === Usage ===
let didge = DidgeridooSynthesizer(fundamentalFreq: 73.4) // D2
didge.blowPressure = 0.6    // medium blow
didge.setTonguePosition(0.3) // slightly dark

// In audio callback:
func audioCallback(buffer: inout [Float], frameCount: Int) {
    for i in 0..<frameCount {
        buffer[i] = didge.generateSample()
    }
}
```

### Synthesis Optimization Notes for iOS

1. **Use `vDSP` / Accelerate framework** for filter operations on buffer-sized chunks
2. **Fixed-point** or **Float32** sufficient (no need for Float64)
3. **Buffer size:** 256–512 samples for low latency (~6–12ms at 44.1kHz)
4. **CPU budget:** Target <10% of one core for the synthesis engine
5. **Formant filter updates:** Only recalculate coefficients when tonguePosition changes (not every sample)
6. **Multiple instances** for binaural mode — two independent synth instances with ±2-8 Hz detuning

---

## 7. Key Academic References

1. Fletcher, N.H. (1996). "The Didjeridu." Acoustics Australia, 24:11-15.
2. Tarnopolsky, A.Z. et al. (2005). "The vocal tract and the sound of a didgeridoo." Nature, 436:39.
3. Tarnopolsky, A.Z. et al. (2006). "Vocal tract resonances and the sound of the Australian didjeridu, I: Experiment." JASA, 119(2):1194.
4. Fletcher, N.H. et al. (2006). "Vocal tract resonances and the sound of the Australian didjeridu, II: Theory." JASA, 119(2):1205.
5. Puhan, M.A. et al. (2006). "Didgeridoo playing as alternative treatment for obstructive sleep apnoea syndrome: randomised controlled trial." BMJ, 332:266-270.
6. Ayers, L. & Horner, A. (2010). "Synthesizing the Dynamic Spectra of the Didgeridoo." Proc. ICMC 2010, pp. 510-513.
7. (2019). "Didgeridoo Sound Meditation for Stress Reduction and Mood Enhancement in Undergraduates: A Randomized Controlled Trial." J Evidence-Based Integrative Medicine, PMC6769210.
8. (2024). "Didge You Sleep: a feasibility study of didgeridoo training for obstructive sleep apnea." Sleep Science and Practice.

---

## 8. Summary: Critical Implementation Priorities

1. **The formant sweep is everything** — the "wah-wah" timbre change IS the didgeridoo sound. Without controllable formants, it's just a boring drone.
2. **Circular breathing rhythm** gives the characteristic pulsation — implement auto-breath cycle.
3. **Deep fundamental (50-80 Hz)** must be felt, not just heard — ensure low-frequency output is preserved.
4. **Waveguide model** provides realistic bore resonance with minimal CPU cost.
5. **Soft saturation** (tanh) adds warmth and prevents harsh digital clipping.
6. **For healing mode:** Auto-formant sweeps, binaural detuning, and breathing guides are the key features.
